(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["GoogleAnalyticsImporter"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["GoogleAnalyticsImporter"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,o){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var l=t[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,o),l.l=!0,l.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)o.d(n,l,function(t){return e[t]}.bind(null,l));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="plugins/GoogleAnalyticsImporter/vue/dist/",o(o.s="fae3")}({"19dc":function(t,o){t.exports=e},"8bbf":function(e,o){e.exports=t},a5a2:function(e,t){e.exports=o},fae3:function(e,t,o){"use strict";if(o.r(t),o.d(t,"ImportScheduler",(function(){return E})),o.d(t,"ImportSchedulerGA4",(function(){return T})),o.d(t,"ImportSelector",(function(){return F})),o.d(t,"ImportStatus",(function(){return Xe})),o.d(t,"ConfigureConnection",(function(){return mt})),"undefined"!==typeof window){var n=window.document.currentScript,l=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);l&&(o.p=l[1])}var r=o("19dc"),a=["Transitions.getTransitions","UsersFlow.getUsersFlow","UsersFlow.getUsersFlowPretty","UsersFlow.getInteractionActions"],i=window,c=i.$;r["Matomo"].on("widget:loaded",(function(e){var t=e.parameters,o=e.element,n="".concat(t.module,".").concat(t.action);if(-1!==a.indexOf(n)){var l=r["Matomo"].importedFromGoogleStartDate,i=r["Matomo"].importedFromGoogleEndDate;if(l&&i){l=Object(r["parseDate"])(l),i=Object(r["parseDate"])(i);var s=r["MatomoUrl"].parsed.value.period,m=r["MatomoUrl"].parsed.value.date,d=r["Periods"].parse(s,m).getDateRange(),p=!(l.getTime()>d[1].getTime()||i.getTime()<d[0].getTime());if(p){var u=Object(r["translate"])("GoogleAnalyticsImporter_LogDataRequiredForReport"),b='<br/> <div class="alert alert-info">'.concat(u,"</div>");c(o).find(".card-content>div").append(b)}}}}));var s=o("8bbf"),m={name:"startDate"},d={name:"endDate"},p={name:"propertyId"},u={name:"accountId"},b={name:"viewId"},g={name:"isMobileApp"},O={name:"timezone"},j={name:"extraCustomDimensions"},y={name:"forceIgnoreOutOfCustomDimSlotError"},h={name:"isVerboseLoggingEnabled"},f=["disabled"];function I(e,t,o,n,l,r){var a=Object(s["resolveComponent"])("Field");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",null,[Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_ScheduleImportDescription")),1),Object(s["createElementVNode"])("div",m,[Object(s["createVNode"])(a,{uicontrol:"text",name:"startDate",modelValue:e.startDate,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.startDate=t}),title:e.translate("GoogleAnalyticsImporter_StartDate"),placeholder:"".concat(e.translate("GoogleAnalyticsImporter_CreationDate")," (YYYY-MM-DD)"),"inline-help":e.translate("GoogleAnalyticsImporter_StartDateHelp")},null,8,["modelValue","title","placeholder","inline-help"])]),Object(s["createElementVNode"])("div",d,[Object(s["createVNode"])(a,{uicontrol:"text",name:"endDate",modelValue:e.endDate,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.endDate=t}),title:e.translate("GoogleAnalyticsImporter_EndDate"),placeholder:e.translate("GoogleAnalyticsImporter_None"),"inline-help":e.endDateHelp},null,8,["modelValue","title","placeholder","inline-help"])]),Object(s["createElementVNode"])("div",p,[Object(s["createVNode"])(a,{uicontrol:"text",name:"propertyId",modelValue:e.propertyId,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.propertyId=t}),placeholder:"eg. UA-XXXXX-X",title:e.translate("GoogleAnalyticsImporter_PropertyId"),"inline-help":e.translate("GoogleAnalyticsImporter_PropertyIdHelp")},null,8,["modelValue","title","inline-help"])]),Object(s["createElementVNode"])("div",u,[Object(s["createVNode"])(a,{uicontrol:"text",name:"accountId",placeholder:"eg. 1234567",modelValue:e.accountId,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.accountId=t}),title:e.translate("GoogleAnalyticsImporter_AccountId"),"inline-help":e.translate("GoogleAnalyticsImporter_AccountIdHelp")},null,8,["modelValue","title","inline-help"])]),Object(s["createElementVNode"])("div",b,[Object(s["createVNode"])(a,{uicontrol:"text",name:"viewId",placeholder:"eg. 1234567",modelValue:e.viewId,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.viewId=t}),title:e.translate("GoogleAnalyticsImporter_ViewId"),"inline-help":e.translate("GoogleAnalyticsImporter_ViewIdHelp")},null,8,["modelValue","title","inline-help"])]),Object(s["createElementVNode"])("div",g,[Object(s["createVNode"])(a,{uicontrol:"checkbox",name:"isMobileApp",modelValue:e.isMobileApp,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.isMobileApp=t}),title:e.translate("GoogleAnalyticsImporter_IsMobileApp"),"inline-help":e.translate("GoogleAnalyticsImporter_IsMobileAppHelp")},null,8,["modelValue","title","inline-help"])]),Object(s["createElementVNode"])("div",O,[Object(s["createVNode"])(a,{uicontrol:"text",name:"timezone",modelValue:e.timezone,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.timezone=t}),title:e.translate("GoogleAnalyticsImporter_Timezone"),placeholder:e.translate("GoogleAnalyticsImporter_Optional"),"inline-help":e.timezoneHelp},null,8,["modelValue","title","placeholder","inline-help"])]),Object(s["createElementVNode"])("div",j,[Object(s["createVNode"])(a,{uicontrol:"multituple",name:"extraCustomDimensions",modelValue:e.extraCustomDimensions,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.extraCustomDimensions=t}),title:e.translate("GoogleAnalyticsImporter_ExtraCustomDimensions"),"inline-help":e.extraCustomDimensionsHelp,"ui-control-attributes":e.extraCustomDimensionsField},null,8,["modelValue","title","inline-help","ui-control-attributes"])]),Object(s["createElementVNode"])("div",y,[Object(s["createVNode"])(a,{uicontrol:"checkbox",name:"forceIgnoreOutOfCustomDimSlotError",modelValue:e.ignoreCustomDimensionSlotCheck,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.ignoreCustomDimensionSlotCheck=t}),title:e.translate("GoogleAnalyticsImporter_ForceCustomDimensionSlotCheck"),"inline-help":e.forceIgnoreOutOfCustomDimSlotErrorHelp},null,8,["modelValue","title","inline-help"])]),Object(s["createElementVNode"])("h3",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_Troubleshooting")),1),Object(s["createElementVNode"])("div",h,[Object(s["createVNode"])(a,{uicontrol:"checkbox",name:"isVerboseLoggingEnabled",modelValue:e.isVerboseLoggingEnabled,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.isVerboseLoggingEnabled=t}),title:e.translate("GoogleAnalyticsImporter_IsVerboseLoggingEnabled"),"inline-help":e.isVerboseLoggingEnabledHelp},null,8,["modelValue","title","inline-help"])]),Object(s["createElementVNode"])("button",{type:"submit",id:"startImportSubmit",class:"btn",onClick:t[10]||(t[10]=function(t){return e.startImport()}),disabled:e.isStartingImport},Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_Start")),9,f)])}var D=o("a5a2"),V=Object(s["defineComponent"])({props:{startImportNonce:{type:String,required:!0},maxEndDateDesc:String,extraCustomDimensionsField:{type:Object,required:!0}},components:{Field:D["Field"]},data:function(){return{isStartingImport:!1,extraCustomDimensions:[],isVerboseLoggingEnabled:!1,ignoreCustomDimensionSlotCheck:!1,startDate:"",endDate:"",propertyId:"",accountId:"",viewId:"",isMobileApp:!1,timezone:""}},created:function(){return this},methods:{startImport:function(){if(this.startDate)try{Object(r["parseDate"])(this.startDate)}catch(o){var e=r["NotificationsStore"].show({message:Object(r["translate"])("GoogleAnalyticsImporter_InvalidDateFormat",["YYYY-MM-DD"]),context:"error",type:"transient"});return void r["NotificationsStore"].scrollToNotification(e)}this.isStartingImport=!0;var t=!this.ignoreCustomDimensionSlotCheck;return r["AjaxHelper"].post({module:"GoogleAnalyticsImporter",action:"startImport",startDate:this.startDate,endDate:this.endDate,propertyId:this.propertyId,viewId:this.viewId,nonce:this.startImportNonce,accountId:this.accountId,isMobileApp:this.isMobileApp?"1":"0",timezone:this.timezone,extraCustomDimensions:this.extraCustomDimensions,isVerboseLoggingEnabled:this.isVerboseLoggingEnabled?"1":"0",forceCustomDimensionSlotCheck:t?"1":"0"},{},{withTokenInUrl:!0}).finally((function(){window.location.reload()}))}},computed:{endDateHelp:function(){var e=Object(r["translate"])("GoogleAnalyticsImporter_EndDateHelpText"),t=this.maxEndDateDesc&&Object(r["translate"])("<br/><br/>GoogleAnalyticsImporter_MaxEndDateHelp",this.maxEndDateDesc);return"".concat(e," ").concat(t||"")},timezoneHelp:function(){var e="https://www.php.net/manual/en/timezones.php";return Object(r["translate"])("GoogleAnalyticsImporter_TimezoneHelp",'<a href="'.concat(e,'" rel="noreferrer noopener" target="_blank">'),"</a>")},extraCustomDimensionsHelp:function(){var e="https://ga-dev-tools.appspot.com/dimensions-metrics-explorer/";return Object(r["translate"])("GoogleAnalyticsImporter_ExtraCustomDimensionsHelp",'<a href="'.concat(e,'" rel="noreferrer noopener" target="_blank">'),"</a>")},forceIgnoreOutOfCustomDimSlotErrorHelp:function(){var e="https://matomo.org/docs/custom-dimensions/";return Object(r["translate"])("GoogleAnalyticsImporter_ForceCustomDimensionSlotCheckHelp",'<a href="'.concat(e,'" rel="noreferrer noopener" target="_blank">'),"</a>")},isVerboseLoggingEnabledHelp:function(){return Object(r["translate"])("GoogleAnalyticsImporter_IsVerboseLoggingEnabledHelp","/path/to/matomo/tmp/logs/","gaimportlog.$idSite.$matomoDomain.log")}}});V.render=I;var E=V,A={name:"startDateGA4"},G={name:"endDateGA4"},_={name:"propertyIdGA4"},S={name:"isMobileAppGA4"},N={name:"timezoneGA4"},v={name:"extraCustomDimensionsGA4"},k={name:"forceIgnoreOutOfCustomDimSlotErrorGA4"},C={name:"isVerboseLoggingEnabledGA4"},x=["disabled"];function w(e,t,o,n,l,r){var a=Object(s["resolveComponent"])("Field");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",null,[Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_ScheduleImportDescription")),1),Object(s["createElementVNode"])("div",A,[Object(s["createVNode"])(a,{uicontrol:"text",name:"startDateGA4",modelValue:e.startDateGA4,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.startDateGA4=t}),title:e.translate("GoogleAnalyticsImporter_StartDate"),placeholder:"".concat(e.translate("GoogleAnalyticsImporter_CreationDate")," (YYYY-MM-DD)"),"inline-help":e.translate("GoogleAnalyticsImporter_StartDateHelp")},null,8,["modelValue","title","placeholder","inline-help"])]),Object(s["createElementVNode"])("div",G,[Object(s["createVNode"])(a,{uicontrol:"text",name:"endDateGA4",modelValue:e.endDateGA4,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.endDateGA4=t}),title:e.translate("GoogleAnalyticsImporter_EndDate"),placeholder:e.translate("GoogleAnalyticsImporter_None"),"inline-help":e.endDateHelp},null,8,["modelValue","title","placeholder","inline-help"])]),Object(s["createElementVNode"])("div",_,[Object(s["createVNode"])(a,{uicontrol:"text",name:"propertyIdGA4",modelValue:e.propertyIdGA4,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.propertyIdGA4=t}),placeholder:"eg. properties/{PROPERTY_ID}",title:e.translate("GoogleAnalyticsImporter_PropertyIdGA4"),"inline-help":e.translate("GoogleAnalyticsImporter_PropertyIdGA4Help")},null,8,["modelValue","title","inline-help"])]),Object(s["createElementVNode"])("div",S,[Object(s["createVNode"])(a,{uicontrol:"checkbox",name:"isMobileAppGA4",modelValue:e.isMobileAppGA4,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.isMobileAppGA4=t}),title:e.translate("GoogleAnalyticsImporter_IsMobileApp"),"inline-help":e.translate("GoogleAnalyticsImporter_IsMobileAppHelp")},null,8,["modelValue","title","inline-help"])]),Object(s["createElementVNode"])("div",N,[Object(s["createVNode"])(a,{uicontrol:"text",name:"timezoneGA4",modelValue:e.timezoneGA4,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.timezoneGA4=t}),title:e.translate("GoogleAnalyticsImporter_Timezone"),placeholder:e.translate("GoogleAnalyticsImporter_Optional"),"inline-help":e.timezoneHelp},null,8,["modelValue","title","placeholder","inline-help"])]),Object(s["createElementVNode"])("div",v,[Object(s["createVNode"])(a,{uicontrol:"multituple",name:"extraCustomDimensionsGA4",modelValue:e.extraCustomDimensionsGA4,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.extraCustomDimensionsGA4=t}),title:e.translate("GoogleAnalyticsImporter_ExtraCustomDimensions"),"inline-help":e.extraCustomDimensionsHelp,"ui-control-attributes":e.extraCustomDimensionsField},null,8,["modelValue","title","inline-help","ui-control-attributes"])]),Object(s["createElementVNode"])("div",k,[Object(s["createVNode"])(a,{uicontrol:"checkbox",name:"forceIgnoreOutOfCustomDimSlotErrorGA4",modelValue:e.ignoreCustomDimensionSlotCheckGA4,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.ignoreCustomDimensionSlotCheckGA4=t}),title:e.translate("GoogleAnalyticsImporter_ForceCustomDimensionSlotCheck"),"inline-help":e.forceIgnoreOutOfCustomDimSlotErrorHelp},null,8,["modelValue","title","inline-help"])]),Object(s["createElementVNode"])("h3",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_Troubleshooting")),1),Object(s["createElementVNode"])("div",C,[Object(s["createVNode"])(a,{uicontrol:"checkbox",name:"isVerboseLoggingEnabledGA4",modelValue:e.isVerboseLoggingEnabledGA4,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.isVerboseLoggingEnabledGA4=t}),title:e.translate("GoogleAnalyticsImporter_IsVerboseLoggingEnabled"),"inline-help":e.isVerboseLoggingEnabledHelp},null,8,["modelValue","title","inline-help"])]),Object(s["createElementVNode"])("button",{type:"submit",id:"startImportSubmitGA4",class:"btn",onClick:t[8]||(t[8]=function(t){return e.startImportGA4()}),disabled:e.isStartingImport},Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_Start")),9,x)])}var M=Object(s["defineComponent"])({props:{startImportNonce:{type:String,required:!0},maxEndDateDesc:String,extraCustomDimensionsField:{type:Object,required:!0}},components:{Field:D["Field"]},data:function(){return{isStartingImport:!1,extraCustomDimensionsGA4:[],isVerboseLoggingEnabledGA4:!1,ignoreCustomDimensionSlotCheckGA4:!1,startDateGA4:"",endDateGA4:"",propertyIdGA4:"",accountId:"",viewId:"",isMobileAppGA4:!1,timezoneGA4:""}},created:function(){return this},methods:{startImportGA4:function(){if(this.startDateGA4)try{Object(r["parseDate"])(this.startDateGA4)}catch(o){var e=r["NotificationsStore"].show({message:Object(r["translate"])("GoogleAnalyticsImporter_InvalidDateFormat",["YYYY-MM-DD"]),context:"error",type:"transient"});return void r["NotificationsStore"].scrollToNotification(e)}this.isStartingImport=!0;var t=!this.ignoreCustomDimensionSlotCheckGA4;return r["AjaxHelper"].post({module:"GoogleAnalyticsImporter",action:"startImportGA4",startDate:this.startDateGA4,endDate:this.endDateGA4,propertyId:this.propertyIdGA4,viewId:this.viewId,nonce:this.startImportNonce,accountId:this.accountId,isMobileApp:this.isMobileAppGA4?"1":"0",timezone:this.timezoneGA4,extraCustomDimensions:this.extraCustomDimensionsGA4,isVerboseLoggingEnabled:this.isVerboseLoggingEnabledGA4?"1":"0",forceCustomDimensionSlotCheck:t?"1":"0"},{},{withTokenInUrl:!0}).finally((function(){window.location.reload()}))}},computed:{endDateHelp:function(){var e=Object(r["translate"])("GoogleAnalyticsImporter_EndDateHelpText"),t=this.maxEndDateDesc&&Object(r["translate"])("<br/><br/>GoogleAnalyticsImporter_MaxEndDateHelp",this.maxEndDateDesc);return"".concat(e," ").concat(t||"")},timezoneHelp:function(){var e="https://www.php.net/manual/en/timezones.php";return Object(r["translate"])("GoogleAnalyticsImporter_TimezoneGA4Help",'<a href="'.concat(e,'" rel="noreferrer noopener" target="_blank">'),"</a>")},extraCustomDimensionsHelp:function(){var e="https://ga-dev-tools.web.app/ga4/dimensions-metrics-explorer/";return Object(r["translate"])("GoogleAnalyticsImporter_ExtraCustomDimensionsGA4Help",'<a href="'.concat(e,'" rel="noreferrer noopener" target="_blank">'),"</a>")},forceIgnoreOutOfCustomDimSlotErrorHelp:function(){var e="https://matomo.org/docs/custom-dimensions/";return Object(r["translate"])("GoogleAnalyticsImporter_ForceCustomDimensionSlotCheckHelp",'<a href="'.concat(e,'" rel="noreferrer noopener" target="_blank">'),"</a>")},isVerboseLoggingEnabledHelp:function(){return Object(r["translate"])("GoogleAnalyticsImporter_IsVerboseLoggingEnabledHelp","/path/to/matomo/tmp/logs/","gaimportlog.$idSite.$matomoDomain.log")}}});M.render=w;var T=M;function B(e,t,o,n,l,r){var a=Object(s["resolveComponent"])("Field"),i=Object(s["resolveDirective"])("form");return Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("div",null,[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(a,{uicontrol:"radio",name:"selectedImporter",modelValue:e.selectedImporter,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.selectedImporter=t}),options:e.importOptionsUa,"inline-help":e.translate("GoogleAnalyticsImporter_SelectImporterUAInlineHelpText")},null,8,["modelValue","options","inline-help"]),Object(s["createVNode"])(a,{uicontrol:"radio",name:"selectedImporter",modelValue:e.selectedImporterGA4,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.selectedImporterGA4=t}),options:e.importOptionsGa4,"inline-help":e.translate("GoogleAnalyticsImporter_SelectImporterGA4InlineHelpText")},null,8,["modelValue","options","inline-help"])])],512)),[[i]])}var H=Object(s["defineComponent"])({props:{importOptionsUa:{type:Object,required:!0},importOptionsGa4:{type:Object,required:!0}},components:{Field:D["Field"]},directives:{Form:D["Form"]},data:function(){return{selectedImporter:"",selectedImporterGA4:""}}});H.render=B;var F=H,U={ref:"root"},R={class:"entityTable importStatusesTable"},L={class:"modal",id:"openScheduleReimportModal"},z={class:"modal-content"},Y={class:"modal-footer"},q={class:"modal",id:"editImportEndDate"},P={class:"modal-content"},$={class:"modal-footer"};function X(e,t,o,n,l,r){var a=Object(s["resolveComponent"])("ImportStatusRow"),i=Object(s["resolveComponent"])("Field"),c=Object(s["resolveDirective"])("tooltips");return Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("div",U,[Object(s["createElementVNode"])("table",R,[Object(s["createElementVNode"])("thead",null,[Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_MatomoSite")),1),Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_GoogleAnalyticsInfo")),1),Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_Status")),1),Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_LatestDayProcessed")),1),Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_ScheduledReImports")),1),Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_StartFinishTimes")),1),Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_Actions")),1)])]),Object(s["createElementVNode"])("tbody",null,[(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.statuses,(function(t,o){return Object(s["openBlock"])(),Object(s["createBlock"])(a,{status:t,key:o,onEndImport:function(o){return e.showEditImportEndDateModal(t.idSite,t.isGA4)},onReimport:function(o){return e.openScheduleReimportModal(t.idSite,t.isGA4)},onDelete:function(o){return e.deleteImportStatus(t.idSite,o.isDone)},onManuallyResume:function(o){return e.manuallyResume(t.idSite,t.isGA4)}},null,8,["status","onEndImport","onReimport","onDelete","onManuallyResume"])})),128))])]),Object(s["createElementVNode"])("div",L,[Object(s["createElementVNode"])("div",z,[Object(s["createElementVNode"])("h3",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_EnterImportDateRange")),1),Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(i,{name:"re-import-start-date",uicontrol:"text",modelValue:e.reimportStartDate,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.reimportStartDate=t}),placeholder:"".concat(e.translate("GoogleAnalyticsImporter_StartDate")," (YYYY-MM-DD)")},null,8,["modelValue","placeholder"])]),Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(i,{name:"re-import-end-date",uicontrol:"text",modelValue:e.reimportEndDate,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.reimportEndDate=t}),placeholder:"".concat(e.translate("GoogleAnalyticsImporter_EndDate")," (YYYY-MM-DD)")},null,8,["modelValue","placeholder"])])]),Object(s["createElementVNode"])("div",Y,[Object(s["createElementVNode"])("a",{id:"scheduleReimportSubmit",href:"",class:"modal-action modal-close btn",onClick:t[2]||(t[2]=Object(s["withModifiers"])((function(t){return e.scheduleReimport()}),["prevent"])),style:{"margin-right":"3.5px"}},Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_Schedule")),1),Object(s["createElementVNode"])("a",{href:"",class:"modal-action modal-close modal-no",onClick:t[3]||(t[3]=Object(s["withModifiers"])((function(){}),["prevent"]))},Object(s["toDisplayString"])(e.translate("General_Cancel")),1)])]),Object(s["createElementVNode"])("div",q,[Object(s["createElementVNode"])("div",P,[Object(s["createElementVNode"])("h3",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_EnterImportEndDate")),1),Object(s["createElementVNode"])("p",null,[Object(s["createElementVNode"])("em",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_LeaveEmptyToRemove")),1)]),Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(i,{name:"new-import-end-date",uicontrol:"text",modelValue:e.newImportEndDate,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.newImportEndDate=t}),placeholder:"".concat(e.translate("GoogleAnalyticsImporter_EndDate")," (YYYY-MM-DD)")},null,8,["modelValue","placeholder"])])]),Object(s["createElementVNode"])("div",$,[Object(s["createElementVNode"])("a",{href:"",class:"modal-action modal-close btn",onClick:t[5]||(t[5]=function(t){return e.changeImportEndDateModal()}),style:{"margin-right":"3.5px"}},Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_Change")),1),Object(s["createElementVNode"])("a",{href:"",class:"modal-action modal-close modal-no",onClick:t[6]||(t[6]=function(t){return e.cancelEditImportEndDateModal()})},Object(s["toDisplayString"])(e.translate("General_Cancel")),1)])])],512)),[[c,{content:e.tooltipContent,delay:500,duration:200}]])}var J=["data-idsite"],W={class:"sitename"},K=["href"],Q={key:1,style:{"text-transform":"uppercase"}},Z=Object(s["createElementVNode"])("br",null,null,-1),ee=["innerHTML"],te={class:"status"},oe={key:0},ne=["title"],le=Object(s["createElementVNode"])("br",null,null,-1),re={key:0},ae={key:1},ie=["title"],ce=Object(s["createElementVNode"])("br",null,null,-1),se={key:0},me={key:2},de=["title"],pe={key:3},ue=["title"],be={key:4},ge=Object(s["createElementVNode"])("br",null,null,-1),Oe=["innerHTML"],je={key:5},ye=["title"],he=Object(s["createElementVNode"])("br",null,null,-1),fe={class:"last-date-imported"},Ie=Object(s["createElementVNode"])("br",null,null,-1),De=Object(s["createElementVNode"])("br",null,null,-1),Ve=Object(s["createElementVNode"])("br",null,null,-1),Ee=Object(s["createElementVNode"])("br",null,null,-1),Ae=Object(s["createElementVNode"])("br",null,null,-1),Ge={key:0},_e={class:"scheduled-reimports"},Se={key:0},Ne={key:1},ve={class:"import-start-finish-times"},ke=Object(s["createElementVNode"])("br",null,null,-1),Ce=Object(s["createElementVNode"])("br",null,null,-1),xe={key:0},we={key:1},Me={key:0},Te={key:1},Be={key:2},He={key:3},Fe={class:"actions"},Ue=["title"],Re=["title"];function Le(e,t,o,n,l,r){var a;return Object(s["openBlock"])(),Object(s["createElementBlock"])("tr",{"data-idsite":e.status.idSite},[Object(s["createElementVNode"])("td",W,[e.status.site?(Object(s["openBlock"])(),Object(s["createElementBlock"])("a",{key:0,target:"_blank",href:e.siteUrl},Object(s["toDisplayString"])(e.siteName),9,K)):(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",Q,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_SiteDeleted")),1)),Z,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_SiteID"))+": "+Object(s["toDisplayString"])(e.status.idSite),1)]),Object(s["createElementVNode"])("td",{class:"ga-info",innerHTML:e.$sanitize(e.gaInfoPretty)},null,8,ee),Object(s["createElementVNode"])("td",te,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.status.status)+" ",1),"rate_limited"===e.status.status?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",oe,[Object(s["createElementVNode"])("span",{class:"icon icon-help",title:e.translate("GoogleAnalyticsImporter_RateLimitHelp")},null,8,ne),le,e.status.days_finished_since_rate_limit?(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",re,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_FinishedImportingDaysWaiting",e.status.days_finished_since_rate_limit)),1)):Object(s["createCommentVNode"])("",!0)])):Object(s["createCommentVNode"])("",!0),"cloud_rate_limited"===e.status.status?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",ae,[Object(s["createElementVNode"])("span",{class:"icon icon-help",title:e.status.error},null,8,ie),ce,e.status.days_finished_since_rate_limit?(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",se,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_FinishedImportingDaysWaiting",e.status.days_finished_since_rate_limit)),1)):Object(s["createCommentVNode"])("",!0)])):Object(s["createCommentVNode"])("",!0),"rate_limited_hourly"===e.status.status?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",me,[Object(s["createElementVNode"])("span",{class:"icon icon-help",title:e.translate("GoogleAnalyticsImporter_RateLimitHourlyHelp")},null,8,de)])):Object(s["createCommentVNode"])("",!0),"future_date_import_pending"===e.status.status?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",pe,[Object(s["createElementVNode"])("span",{class:"icon icon-help",title:e.translate("GoogleAnalyticsImporter_FutureDateHelp",e.status.future_resume_date)},null,8,ue)])):"errored"===e.status.status?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",be,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_ErrorMessage"))+": "+Object(s["toDisplayString"])(e.status.error||"no message")+" ",1),ge,Object(s["createElementVNode"])("span",{innerHTML:e.$sanitize(e.errorMessageBugReportRequest)},null,8,Oe)])):"killed"===e.status.status?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",je,[Object(s["createElementVNode"])("span",{class:"icon icon-help",title:e.translate("GoogleAnalyticsImporter_KilledStatusHelp")},null,8,ye),he,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_ErrorMessage"))+": "+Object(s["toDisplayString"])(e.status.error||"no message"),1)])):Object(s["createCommentVNode"])("",!0)]),Object(s["createElementVNode"])("td",fe,[Object(s["createElementVNode"])("div",null,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_LastDayImported"))+": "+Object(s["toDisplayString"])(e.status.last_date_imported||e.noneText),1),Ie,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_LastDayArchived"))+": "+Object(s["toDisplayString"])(e.status.last_day_archived||e.noneText),1),De,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_ImportStartDate"))+": "+Object(s["toDisplayString"])(e.status.import_range_start||e.websiteCreationTime)+" ",1),Ve,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_ImportEndDate"))+": "+Object(s["toDisplayString"])(e.status.import_range_end||e.noneText)+" ",1),Ee,Ae]),"finished"!==e.status.status?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",Ge,[Object(s["createElementVNode"])("a",{class:"edit-import-end-link table-command-link",href:"",onClick:t[0]||(t[0]=Object(s["withModifiers"])((function(t){return e.$emit("end-import")}),["prevent"]))},Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_EditEndDate")),1)])):Object(s["createCommentVNode"])("",!0),Object(s["createElementVNode"])("div",null,[Object(s["createElementVNode"])("a",{id:"reimport-date-range",class:"table-command-link",href:"",onClick:t[1]||(t[1]=Object(s["withModifiers"])((function(t){return e.$emit("reimport")}),["prevent"]))},Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_ReimportDate")),1)])]),Object(s["createElementVNode"])("td",_e,[null!==(a=e.status.reimport_ranges)&&void 0!==a&&a.length?(Object(s["openBlock"])(),Object(s["createElementBlock"])("ul",Se,[(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.status.reimport_ranges,(function(e,t){return Object(s["openBlock"])(),Object(s["createElementBlock"])("li",{key:t},Object(s["toDisplayString"])(e[0])+","+Object(s["toDisplayString"])(e[1]),1)})),128))])):(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",Ne,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_None")),1))]),Object(s["createElementVNode"])("td",ve,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_ImportStartTime"))+": "+Object(s["toDisplayString"])(e.status.import_start_time||e.noneText),1),ke,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_LastResumeTime"))+": "+Object(s["toDisplayString"])(e.status.last_job_start_time||e.noneText),1),Ce,"finished"===e.status.status?(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",xe,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_TimeFinished"))+": "+Object(s["toDisplayString"])(e.status.import_end_time||e.noneText),1)):e.status.estimated_days_left_to_finish?(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",we,[e.thisJobShouldFinishToday?(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",Me,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_ThisJobShouldFinishToday")),1)):(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",Te,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_EstimatedFinishIn",e.status.estimated_days_left_to_finish)),1))])):e.status.import_range_end?(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",Be,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_JobWillRunUntilManuallyCancelled")),1)):(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",He,Object(s["toDisplayString"])(e.translate("General_Unknown")),1))]),Object(s["createElementVNode"])("td",Fe,[Object(s["createElementVNode"])("a",{class:Object(s["normalizeClass"])(["table-action",{"icon-delete":e.isDone,"icon-close":!e.isDone}]),onClick:t[2]||(t[2]=Object(s["withModifiers"])((function(t){return e.$emit("delete",{isDone:e.isDone})}),["prevent"])),title:e.isDone?e.translate("General_Remove"):e.translate("General_Cancel")},null,10,Ue),-1===["finished","ongoing","started"].indexOf(e.status.status)?(Object(s["openBlock"])(),Object(s["createElementBlock"])("a",{key:0,class:"table-action icon-play",onClick:t[3]||(t[3]=Object(s["withModifiers"])((function(t){return e.$emit("manuallyResume")}),["prevent"])),title:e.translate("GoogleAnalyticsImporter_ResumeDesc")},null,8,Re)):Object(s["createCommentVNode"])("",!0)])],8,J)}var ze=Object(s["defineComponent"])({props:{status:{type:Object,required:!0}},emits:["end-import","reimport","delete","manuallyResume"],computed:{isDone:function(){return"finished"===this.status.status},siteUrl:function(){return"?".concat(r["MatomoUrl"].stringify(Object.assign(Object.assign({period:"day",date:"today"},r["MatomoUrl"].urlParsed.value),{},{idSite:this.status.idSite,module:"CoreHome",action:"index"})))},gaInfoPretty:function(){return(this.status.gaInfoPretty||"").replace(/\n/g,"<br/>")},errorMessageBugReportRequest:function(){return Object(r["translate"])("GoogleAnalyticsImporter_ErrorMessageBugReportRequest",'<a href="https://forum.matomo.org/" rel="noreferrer noopener" target="_blank">',"</a>")},thisJobShouldFinishToday:function(){return 0===this.status.estimated_days_left_to_finish||"0"===this.status.estimated_days_left_to_finish},siteName:function(){var e;return r["Matomo"].helper.htmlDecode(null===(e=this.status.site)||void 0===e?void 0:e.name)},noneText:function(){return Object(r["translate"])("GoogleAnalyticsImporter_None")},websiteCreationTime:function(){return Object(r["translate"])("GoogleAnalyticsImporter_CreationDate")}}});ze.render=Le;var Ye=ze,qe=window,Pe=qe.$,$e=Object(s["defineComponent"])({props:{statuses:{type:Array,required:!0},stopImportNonce:{type:String,required:!0},changeImportEndDateNonce:{type:String,required:!0},resumeImportNonce:{type:String,required:!0},scheduleReImportNonce:{type:String,required:!0}},components:{Field:D["Field"],ImportStatusRow:Ye},directives:{Tooltips:r["Tooltips"]},data:function(){return{editImportEndDateIdSite:null,reimportDateRangeIdSite:null,reimportStartDate:"",reimportEndDate:"",newImportEndDate:"",isGA4:!1}},methods:{showEditImportEndDateModal:function(e,t){this.editImportEndDateIdSite=e,this.isGA4=t,Pe("#editImportEndDate").modal({dismissible:!1}).modal("open")},cancelEditImportEndDateModal:function(){this.editImportEndDateIdSite=null,this.isGA4=!1},manuallyResume:function(e,t){return r["AjaxHelper"].post({module:"GoogleAnalyticsImporter",action:"resumeImport",idSite:e,isGA4:t?1:0,nonce:this.resumeImportNonce},{},{withTokenInUrl:!0}).finally((function(){window.location.reload()}))},deleteImportStatus:function(e,t){var o=this;if(t)return r["AjaxHelper"].post({module:"GoogleAnalyticsImporter",action:"deleteImportStatus",idSite:e,nonce:this.stopImportNonce},{},{withTokenInUrl:!0}).finally((function(){window.location.reload()}));r["Matomo"].helper.modalConfirm("#confirmCancelJob",{yes:function(){o.deleteImportStatus(e,!0)}})},openScheduleReimportModal:function(e,t){this.reimportDateRangeIdSite=e,this.isGA4=t,Pe("#openScheduleReimportModal").modal({dismissible:!1}).modal("open")},changeImportEndDateModal:function(){return r["AjaxHelper"].post({module:"GoogleAnalyticsImporter",action:"changeImportEndDate",idSite:this.editImportEndDateIdSite,nonce:this.changeImportEndDateNonce,endDate:this.newImportEndDate},{},{withTokenInUrl:!0}).finally((function(){window.location.reload()}))},scheduleReimport:function(){return r["AjaxHelper"].post({module:"GoogleAnalyticsImporter",action:"scheduleReImport",idSite:this.reimportDateRangeIdSite,startDate:this.reimportStartDate,endDate:this.reimportEndDate,nonce:this.scheduleReImportNonce,isGA4:this.isGA4?1:0},{},{withTokenInUrl:!0}).finally((function(){window.location.reload()}))}},computed:{tooltipContent:function(){return function(){var e=Pe(this);if(""===e.attr("piwik-field"))return"";var t=Pe(this).attr("title")||"";return window.vueSanitize(t.replace(/\n/g,"<br />"))}}}});$e.render=X;var Xe=$e,Je={class:"form-group row"},We={class:"col s12 m6"},Ke=Object(s["createElementVNode"])("br",null,null,-1),Qe=["innerHTML"],Ze={class:"col s12 m6"},et=["innerHTML"],tt={class:"form-group row"},ot={class:"col s12 m6"},nt=["action"],lt=["value"],rt=["disabled"],at=Object(s["createElementVNode"])("span",{class:"icon-upload"},null,-1),it=Object(s["createElementVNode"])("span",{class:"icon-upload"},null,-1);function ct(e,t,o,n,l,r){return Object(s["openBlock"])(),Object(s["createElementBlock"])(s["Fragment"],null,[Object(s["createElementVNode"])("div",Je,[Object(s["createElementVNode"])("div",We,[Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_ConfigureTheImporterLabel1")),1),Object(s["createElementVNode"])("p",null,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_ConfigureTheImporterLabel2")),1),Ke,Object(s["createElementVNode"])("span",{innerHTML:e.$sanitize(e.setupGoogleAnalyticsImportFaq)},null,8,Qe)])]),Object(s["createElementVNode"])("div",Ze,[Object(s["createElementVNode"])("div",{class:"form-help",innerHTML:e.$sanitize(e.translate("GoogleAnalyticsImporter_ConfigureTheImporterHelp","<strong>","</strong>"))},null,8,et)])]),Object(s["createElementVNode"])("div",tt,[Object(s["createElementVNode"])("div",ot,[Object(s["createElementVNode"])("form",{id:"configFileUploadForm",action:e.actionUrl,method:"POST",enctype:"multipart/form-data"},[Object(s["createElementVNode"])("input",{type:"file",id:"clientfile",name:"clientfile",accept:".json",onChange:t[0]||(t[0]=function(){return e.processFileChange&&e.processFileChange.apply(e,arguments)}),style:{display:"none"}},null,32),Object(s["createElementVNode"])("input",{type:"hidden",name:"config_nonce",value:e.configNonce},null,8,lt),Object(s["createElementVNode"])("button",{type:"button",class:"btn",onClick:t[1]||(t[1]=function(t){return e.selectConfigFile()}),disabled:e.isUploadButtonDisabled},[Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,[at,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("General_Upload")),1)],512),[[s["vShow"],!e.isUploadButtonDisabled]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",null,[it,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("GoogleAnalyticsImporter_Uploading")),1)],512),[[s["vShow"],e.isUploadButtonDisabled]])],8,rt)],8,nt)])])],64)}var st=Object(s["defineComponent"])({data:function(){return{isSelectingFile:!1,isUploading:!1}},props:{actionUrl:{type:String,required:!0},configNonce:{type:String,required:!0}},methods:{selectConfigFile:function(){this.isSelectingFile=!0;var e=document.getElementById("clientfile");e&&e.click()},processFileChange:function(){var e=document.getElementById("clientfile"),t=document.getElementById("configFileUploadForm");e&&e.value&&t&&(this.isUploading=!0,t.submit())},checkForCancel:function(){if(this.isSelectingFile&&!this.isUploading){var e=document.getElementById("clientfile");e&&!e.value&&(this.isSelectingFile=!1)}}},computed:{setupGoogleAnalyticsImportFaq:function(){var e="https://matomo.org/faq/general/set-up-google-analytics-import/";return Object(r["translate"])("GoogleAnalyticsImporter_ConfigureTheImporterLabel3",'<a href="'.concat(e,'" rel="noreferrer noopener" target="_blank">'),"</a>")},isUploadButtonDisabled:function(){return this.isSelectingFile||this.isUploading}},mounted:function(){document.body.onfocus=this.checkForCancel}});st.render=ct;var mt=st;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# sourceMappingURL=GoogleAnalyticsImporter.umd.min.js.map